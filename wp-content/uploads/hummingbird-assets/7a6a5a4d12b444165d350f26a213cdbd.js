/**handles:nova-poshta-js**/
jQuery(document).ready(function(){if(document.getElementById("billing_nova_poshta_city")){function o(){console.log("calculatex");var o={action:"my_actionfogetnpshippngcost",c2:jQuery("#billing_nova_poshta_city").val(),cod:jQuery("#payment_method_cod").attr("checked")};jQuery.post(NovaPoshtaHelper.ajaxUrl,o,function(o){jQuery("#shipcost").remove(),o.includes("01234")||0==o?console.log("abortad"):(jQuery(".order-total").after('<tr id=shipcost class=order-total><th>Розрахунок вартості доставки</th><td><strong><span class="woocommerce-Price-currencySymbol">₴</span>'+o+"<strong></td></tr>"),console.log(o))})}jQuery("#billing_nova_poshta_city").change(function(){o()}),jQuery("body").on("click",".wc_payment_method",function(){console.log("changed payment method"),setTimeout(function(){o()},20),setTimeout(function(){o()},500),setTimeout(function(){o()},4e3)}),jQuery("body").on("click",".shipping_method",function(){console.log("changed shipping method"),console.log(jQuery(this).val()),"nova_poshta_shipping_method"==jQuery(this).val()?(o(),setTimeout(function(){o()},500),setTimeout(function(){o()},4e3)):jQuery("#shipcost").remove()});var e={matcher:function(o,e){if(""===jQuery.trim(o.term))return e;if(void 0===e.text)return null;var t=jQuery.trim(o.term).toLowerCase();return t===jQuery.trim(e.text).toLowerCase().substr(0,t.length)?e:null},minimumInputLength:2,maximumDisplayOptionsLength:50,templateResult:function(o){return o.loading?o.text:(o.id=o.id,o.code,o.text)},templateSelection:function(o){return o.text},language:{errorLoading:function(){return"Завантаження."},inputTooShort:function(){return"Введіть більше символів..."},noResults:function(){return"Нічого не знайдено"},searching:function(){return"Пошук…"}}};jQuery("#billing_nova_poshta_city").select2(e),jQuery("#shipping_nova_poshta_city").select2(e),jQuery("#billing_nova_poshta_warehouse").select2(),jQuery("#billing_nova_poshta_region").select2(),jQuery("#shipping_nova_poshta_warehouse").select2(),jQuery("#shipping_nova_poshta_region").select2(),jQuery("#billing_nova_poshta_region").on("change",function(){jQuery("#billing_nova_poshta_city").select2("val",""),jQuery("#billing_nova_poshta_warehouse").select2("val","")}),jQuery("#billing_nova_poshta_city").on("change",function(){jQuery("#billing_nova_poshta_warehouse").select2("val","")}),jQuery("#shipping_nova_poshta_region").on("change",function(){jQuery("#shipping_nova_poshta_city").select2("val",""),jQuery("#shipping_nova_poshta_warehouse").select2("val","")}),jQuery("#shipping_nova_poshta_city").on("change",function(){jQuery("#shipping_nova_poshta_warehouse").select2("val","")})}var t,n,i,a,r,s,c,l,p,h,u,_,d,g,v,f,m,y,b,j,Q=(t=jQuery,n={},i=t("#billing_nova_poshta_region, #billing_nova_poshta_city, #billing_nova_poshta_warehouse"),a=t("#billing_nova_poshta_region"),r=t("#billing_nova_poshta_city"),s=t("#billing_nova_poshta_warehouse"),c=t("#shipping_nova_poshta_region, #shipping_nova_poshta_city, #shipping_nova_poshta_warehouse"),l=t("#shipping_nova_poshta_region"),p=t("#shipping_nova_poshta_city"),h=t("#shipping_nova_poshta_warehouse"),u=t("#billing_address_1, #billing_address_2, #billing_city, #billing_state, #billing_postcode"),_=t("#shipping_address_1, #shipping_address_2, #shipping_city, #shipping_state, #shipping_postcode"),d=t("input[name^=shipping_method][type=radio]"),g=t("#ship-to-different-address-checkbox"),v=function(){u.each(function(){t(this).removeAttr("disabled").closest(".form-row").show()})},f=function(){u.each(function(){t(this).attr("disabled","disabled").closest(".form-row").hide()})},m=function(){_.each(function(){t(this).removeAttr("disabled").closest(".form-row").show()})},y=function(){_.each(function(){t(this).attr("disabled","disabled").closest(".form-row").hide()})},b=function(){i.each(function(){t(this).attr("disabled","disabled").closest(".form-row").hide()}),v(),c.each(function(){t(this).attr("disabled","disabled").closest(".form-row").hide()}),m()},j=function(){var o;b(),(o=t("input[name^=shipping_method][type=radio]:checked").val())||(o=t("input#shipping_method_0").val()),o||(o=t("input[name^=shipping_method][type=hidden]").val()),o||jQuery.post(NovaPoshtaHelper.ajaxUrl,{action:"my_action_for_wc_get_chosen_method_ids"},function(e){o=e}),(jQuery("#billing_country").val()&&(console.log(jQuery("#billing_country").val()),"UA"!=jQuery("#billing_country").val())?(console.log("185: return false"),0):!o||"nova_poshta_shipping_method"===o)&&(g.is(":checked")?(c.each(function(){t(this).removeAttr("disabled").closest(".form-row").show()}),y()):(i.each(function(){t(this).removeAttr("disabled").closest(".form-row").show()}),f()))},n.init=function(){t(document).on("change",d,function(){j()}),t(document).on("change",g,function(){j()}),t(document.body).bind("updated_checkout",function(){j()}),j(),a.on("change",function(){var o=this.value;t.ajax({url:NovaPoshtaHelper.ajaxUrl,method:"POST",data:{action:NovaPoshtaHelper.getCitiesAction,parent_ref:o},success:function(o){try{var e=JSON.parse(o);r.find("option:not(:first-child)").remove(),t.each(e,function(o,e){r.append(t("<option></option>").attr("value",o).text(e))}),s.find("option:not(:first-child)").remove()}catch(e){console.log("Error. Response from server was: "+o)}},error:function(){console.log("Error.")}})}),r.on("change",function(){var o=this.value;t.ajax({url:NovaPoshtaHelper.ajaxUrl,method:"POST",data:{action:NovaPoshtaHelper.getWarehousesAction,parent_ref:o},success:function(o){try{var e=JSON.parse(o);s.find("option:not(:first-child)").remove(),t.each(e,function(o,e){s.append(t("<option></option>").attr("value",o).text(e))})}catch(e){console.log("Error. Response from server was: "+o)}},error:function(){console.log("Error.")}})}),l.on("change",function(){var o=this.value;t.ajax({url:NovaPoshtaHelper.ajaxUrl,method:"POST",data:{action:NovaPoshtaHelper.getCitiesAction,parent_ref:o},success:function(o){try{var e=JSON.parse(o);p.find("option:not(:first-child)").remove(),t.each(e,function(o,e){p.append(t("<option></option>").attr("value",o).text(e))}),h.find("option:not(:first-child)").remove()}catch(e){console.log("Error. Response from server was: "+o)}},error:function(){console.log("Error.")}})}),p.on("change",function(){var o=this.value;t.ajax({url:NovaPoshtaHelper.ajaxUrl,method:"POST",data:{action:NovaPoshtaHelper.getWarehousesAction,parent_ref:o},success:function(o){try{var e=JSON.parse(o);h.find("option:not(:first-child)").remove(),t.each(e,function(o,e){h.append(t("<option></option>").attr("value",o).text(e))})}catch(e){console.log("Error. Response from server was: "+o)}},error:function(){console.log("Error.")}})})},n),w=function(o){var e={},t=function(){var e=o("input[name^=shipping_method][type=radio]:checked").val();return e||(e=o("input#shipping_method_0").val()),"nova_poshta_shipping_method"===e},n=function(){o("#calc_shipping_country").find("option").each(function(){"UA"!==o(this).val()&&o(this).remove()}),o("#calc_shipping_state_field").hide();var e=o('<input type="hidden" id="calc_nova_poshta_shipping_method" value="nova_poshta_shipping_method" name="shipping_method">'),t=o('<input type="hidden" id="calc_nova_poshta_shipping_city" name="calc_nova_poshta_shipping_city">');o("#calc_shipping_city_field").append(t).append(e);var n=o("#calc_shipping_city");n.autocomplete({source:function(o,e){jQuery.ajax({type:"POST",url:NovaPoshtaHelper.ajaxUrl,data:{action:NovaPoshtaHelper.getCitiesByNameSuggestionAction,name:o.term},success:function(o){var t=JSON.parse(o);e(jQuery.map(t,function(o,e){return{label:o,value:e}}))}})},focus:function(o,e){return n.val(e.item.label),!1},select:function(o,e){return n.val(e.item.label),t.val(e.item.value),!1}}),o("form.woocommerce-shipping-calculator").on("submit",function(){if("UA"!==o("#calc_shipping_country").val())return!1})};return e.init=function(){o(document.body).bind("updated_wc_div updated_shipping_method",function(){t()&&n()}),t()&&n()},e}(jQuery);Q.init(),w.init(),setTimeout(function(){jQuery("#billing_country").trigger("change",[])},600)});